<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd">

	<bean id="exceptionResolver"
		class="org.springframework.web.servlet.handler.SimpleMappingExceptionResolver">
		<property name="exceptionMappings">
			<props>
				<prop
					key="org.springframework.dao.DataAccessException">
					dataAccessFailure
				</prop>
			</props>
		</property>
	</bean>

	<bean id="filenameController"
		class="org.springframework.web.servlet.mvc.UrlFilenameViewController" />

	<bean id="fileUploadController"
		class="org.appfuse.webapp.controller.FileUploadController">
		<property name="validator" ref="beanValidator" />
		<property name="cancelView" value="redirect:mainMenu.html" />
		<property name="formView" value="uploadForm" />
		<property name="successView" value="uploadDisplay" />
	</bean>

	<bean id="passwordHintController"
		class="org.appfuse.webapp.controller.PasswordHintController">
		<property name="userManager" ref="userManager" />
		<property name="messageSource" ref="messageSource" />
		<property name="mailEngine" ref="mailEngine" />
		<property name="message" ref="mailMessage" />
	</bean>

	<bean id="reloadController"
		class="org.appfuse.webapp.controller.ReloadController" />

	<bean id="signupController"
		class="org.appfuse.webapp.controller.SignupController">
		<property name="validator" ref="beanValidator" />
		<property name="formView" value="signup" />
		<property name="successView" value="redirect:mainMenu.html" />
		<property name="userManager" ref="userManager" />
		<property name="roleManager" ref="roleManager" />
		<property name="mailEngine" ref="mailEngine" />
		<property name="message" ref="mailMessage" />
		<property name="templateName" value="accountCreated.vm" />
	</bean>

	<bean id="userController"
		class="org.appfuse.webapp.controller.UserController">
		<property name="userManager" ref="userManager" />
	</bean>

	<bean id="userFormController"
		class="org.appfuse.webapp.controller.UserFormController">
		<property name="validator" ref="beanValidator" />
		<property name="formView" value="userForm" />
		<property name="successView" value="redirect:users.html" />
		<property name="cancelView" value="redirect:mainMenu.html" />
		<property name="userManager" ref="userManager" />
		<property name="roleManager" ref="roleManager" />
		<property name="mailEngine" ref="mailEngine" />
		<property name="message" ref="mailMessage" />
		<property name="templateName" value="accountCreated.vm" />
	</bean>

	<!--Authority-START-->
	<bean id="authorityController"
		class="com.pobox.paging.webapp.controller.AuthorityController">
		<property name="manager" ref="pagingLookupManager" />
		<property name="paginateListFactory" ref="paginatedListFactory" />
	</bean>

	<bean id="authorityFormController"
		class="com.pobox.paging.webapp.controller.AuthorityFormController">
		<property name="validator" ref="beanValidator" />
		<property name="successView" value="redirect:authorities.html" />
		<property name="authorityManager" ref="authorityManager" />
	</bean>
	<!--Authority-END-->

	<!-- ====  COMPASS SEARCH CONTROLLER ==== -->
	<bean id="andDefaultCompassSearchHelper"
		class="com.firstworldtoys.util.AndDefaultCompassSearchHelper">
		<constructor-arg index="0">
			<ref bean="compass" />
		</constructor-arg>
		<constructor-arg index="1">
			<value>10</value>
		</constructor-arg>
	</bean>
	<bean id="searchController"
		class="org.compass.spring.web.mvc.CompassSearchController">
		<property name="searchHelper"
			ref="andDefaultCompassSearchHelper" />
		<property name="compass">
			<ref bean="compass" />
		</property>
		<property name="searchView">
			<value>searchView</value>
		</property>
		<property name="searchResultsView">
			<value>searchResultsView</value>
		</property>
		<property name="pageSize">
			<value>10</value>
		</property>
	</bean>
	<!-- ====  COMPASS INDEX CONTROLLER ==== -->
	<bean id="indexController"
		class="org.compass.spring.web.mvc.CompassIndexController">
		<property name="compassGps">
			<ref bean="compassGps" />
		</property>
		<property name="indexView">
			<value>reindexView</value>
		</property>
		<property name="indexResultsView">
			<value>reindexResultsView</value>
		</property>
	</bean>

	<!--  RESOLVER -->
	<bean id="multipartResolver"
		class="org.springframework.web.multipart.commons.CommonsMultipartResolver">
		<property name="maxUploadSize" value="2097152" />
	</bean>

	<bean id="messageSource"
		class="org.springframework.context.support.ResourceBundleMessageSource">
		<property name="basename" value="ApplicationResources" />
		<property name="useCodeAsDefaultMessage" value="true" />
	</bean>

	<bean id="urlMapping"
		class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
		<property name="mappings">
			<value>
				/admin/activeUsers.html=filenameController
				/admin/flushCache.html=filenameController
				/admin/reload.html=reloadController
				/admin/users.html=userController
				/mainMenu.html=filenameController
				/passwordHint.html=passwordHintController
				/authorities.html=authorityController
				/search.html=searchController
				/reindex.html=indexController
			</value>
		</property>
		<property name="order" value="0" />
	</bean>

	<bean
		class="org.springframework.web.servlet.mvc.support.ControllerClassNameHandlerMapping">
		<property name="order" value="1" />
	</bean>

	<!-- View Resolver for JSPs -->
	<bean id="viewResolver"
		class="org.springframework.web.servlet.view.InternalResourceViewResolver">
		<property name="requestContextAttribute" value="rc" />
		<property name="viewClass"
			value="org.springframework.web.servlet.view.JstlView" />
		<property name="prefix" value="/WEB-INF/pages/" />
		<property name="suffix" value=".jsp" />
	</bean>
	    <!-- View Resolver for JSPs --> 
    <bean id="rbViewResolver" 
class="org.springframework.web.servlet.view.ResourceBundleViewResolver"> 
                <property name="basename"><value>views</value></property> 
                <property name="order"><value>0</value></property> 
        </bean> 
</beans>
